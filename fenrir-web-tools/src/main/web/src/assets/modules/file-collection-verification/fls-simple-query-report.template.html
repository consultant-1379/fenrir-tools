<md-dialog aria-label="Run FLS basic query">
  <md-dialog-content>
    <md-toolbar md-autofocus="">
      <div class="md-toolbar-tools">
        <h2>Run Simple FLS Query</h2>
        <span flex=""></span>
        <md-button class="md-icon-button" ng-click="cancelOrClose()">
          <md-icon aria-label="Close"
                   md-svg-src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjwvc3ZnPg=="></md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-dialog-actions>
      <md-button class="md-primary" ng-click="downloadAsCsv()">Download as CSV</md-button>
    </md-dialog-actions>
    <md-content layout-padding="">
      <div layout="column" layout-align="start center">
        <fieldset>
          <legend>Report parameters</legend>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable search by ROP start/end times"
                         ng-model="report.flsSimpleQuery.inputParams.ropTimeSearchCriteriaEnabled"></md-switch>
            </md-input-container>
            <md-input-container class="md-block" flex-gt-xs="">
              <label>ROP Start time:</label>
              <input class=" dtp-no-msclear dtp-input md-input" date="true" edit-input="true"
                     id="report.common.inputParams.ropStartTime" max-date="date" mdc-datetime-picker="" min-date="date"
                     minutes="true" name="ropStartTime"
                     ng-disabled="!report.flsSimpleQuery.inputParams.ropTimeSearchCriteriaEnabled"
                     ng-model="report.common.inputParams.ropStartTime" placeholder="YYYY-MM-DD HH:MM" short-time="true"
                     show-icon="true" show-todays-date="true" time="true" type="text"/>
            </md-input-container>
            <md-input-container class="md-block" flex-gt-xs="">
              <label>ROP End time:</label>
              <input class=" dtp-no-msclear dtp-input md-input" date="true" edit-input="true"
                     id="report.common.inputParams.ropEndTime" max-date="maxDateNow" mdc-datetime-picker=""
                     min-date="minDate" minutes="true" name="ropEndTime"
                     ng-disabled="!report.flsSimpleQuery.inputParams.ropTimeSearchCriteriaEnabled"
                     ng-model="report.common.inputParams.ropEndTime" placeholder="YYYY-MM-DD HH:MM" short-time="true"
                     show-icon="true" show-todays-date="true" time="true" type="text"/>
            </md-input-container>
          </div>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable search by FLS file creation start/end times"
                         ng-model="report.flsSimpleQuery.inputParams.fileCreationTimeSearchCriteriaEnabled"></md-switch>
            </md-input-container>
            <md-input-container class="md-block" flex-gt-xs="">
              <label>File creation start time:</label>
              <input class=" dtp-no-msclear dtp-input md-input" date="true" edit-input="true"
                     id="report.flsSimpleQuery.inputParams.fileCreationStartTime" max-date="date" mdc-datetime-picker=""
                     min-date="date" minutes="true" name="ropStartTime"
                     ng-disabled="!report.flsSimpleQuery.inputParams.fileCreationTimeSearchCriteriaEnabled"
                     ng-model="report.flsSimpleQuery.inputParams.fileCreationStartTime" placeholder="YYYY-MM-DD HH:MM"
                     short-time="true" show-icon="true" show-todays-date="true" time="true" type="text"/>
            </md-input-container>
            <md-input-container class="md-block" flex-gt-xs="">
              <label>File creation end time:</label>
              <input class=" dtp-no-msclear dtp-input md-input" date="true" edit-input="true"
                     id="report.flsSimpleQuery.inputParams.fileCreationEndTime" max-date="date" mdc-datetime-picker=""
                     min-date="date" minutes="true" name="ropStartTime"
                     ng-disabled="!report.flsSimpleQuery.inputParams.fileCreationTimeSearchCriteriaEnabled"
                     ng-model="report.flsSimpleQuery.inputParams.fileCreationEndTime" placeholder="YYYY-MM-DD HH:MM"
                     short-time="true" show-icon="true" show-todays-date="true" time="true" type="text"/>
            </md-input-container>
          </div>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable search by node name"
                         ng-model="report.flsSimpleQuery.inputParams.nodeNameSearchCriteriaEnabled"></md-switch>
            </md-input-container>
            <md-input-container>
              <label>Criteria</label>
              <md-select ng-disabled="!report.flsSimpleQuery.inputParams.nodeNameSearchCriteriaEnabled"
                         ng-model="report.flsSimpleQuery.inputParams.nodeNameSearchCriteriaOperator">
                <md-option value="EQUALS">EQUALS</md-option>
                <md-option value="NOT_EQUALS">NOT EQUALS</md-option>
                <md-option value="LIKE">LIKE</md-option>
                <md-option value="NOT_LIKE">NOT LIKE</md-option>
              </md-select>
            </md-input-container>
            <md-input-container>
              <label>Node name</label>
              <input ng-disabled="!report.flsSimpleQuery.inputParams.nodeNameSearchCriteriaEnabled"
                     ng-model="report.flsSimpleQuery.inputParams.nodeName"/>
            </md-input-container>
          </div>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable search by node types"
                         ng-model="report.flsSimpleQuery.inputParams.nodeTypesSearchCriteriaEnabled"></md-switch>
            </md-input-container>
            <md-input-container>
              <label>Node types</label>
              <md-chips input-aria-label="Node types" md-max-chips="5" md-removable="true"
                        name="report.flsSimpleQuery.inputParams.nodeTypes"
                        ng-model="report.flsSimpleQuery.inputParams.nodeTypes" placeholder="Enter a node type..."
                        readonly="!report.flsSimpleQuery.inputParams.nodeTypesSearchCriteriaEnabled">
                <md-chip-template>
                  <strong>{{ $chip }}</strong>
                </md-chip-template>
              </md-chips>
              <div class="errors" ng-messages="report.flsSimpleQuery.inputParams.nodeTypes.$error">
                <div ng-message="md-max-chips">Maximum number of chips reached.</div>
              </div>
            </md-input-container>
          </div>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable search by FLS data types"
                         ng-model="report.flsSimpleQuery.inputParams.dataTypesSearchCriteriaEnabled"></md-switch>
            </md-input-container>
            <md-input-container class="md-block">
              <label>FLS data types</label>
              <md-chips input-aria-label="FLS Data types" md-autocomplete-snap="" md-require-match="true"
                        ng-model="report.common.inputParams.dataTypes">
                <md-autocomplete input-aria-describedby="autocompleteTitle" md-item-text="flsDataType"
                                 md-items="flsDataType in flsDataTypeQuerySearch(report.flsSimpleQuery.inputParams.dataTypesSearchText)"
                                 md-search-text="report.flsSimpleQuery.inputParams.dataTypesSearchText"
                                 md-selected-item="report.flsSimpleQuery.inputParams.dataTypesSelectedItem"
                                 ng-disabled="!report.flsSimpleQuery.inputParams.dataTypesSearchCriteriaEnabled"
                                 placeholder="Start typing for suggestions">
                  <span
                    md-highlight-text="report.flsSimpleQuery.inputParams.dataTypesSearchText">{{ flsDataType }}</span>
                </md-autocomplete>
                <md-chip-template>
                                    <span>
                                        <strong>{{ $chip }}</strong>
                                    </span>
                </md-chip-template>
              </md-chips>
            </md-input-container>
          </div>
          <div layout="row">
            <md-input-container class="md-block">
              <md-switch aria-label="Enable/Disable limiting the number of records to retrieve"
                         ng-model="report.common.inputParams.maxRecordsToRetrieveEnabled"></md-switch>
            </md-input-container>
            <md-input-container class="md-block" flex-gt-xs="">
              <label>Max records to retrieve</label>
              <input ng-disabled="!report.common.inputParams.maxRecordsToRetrieveEnabled"
                     ng-model="report.common.inputParams.maxRecordsToRetrieve"/>
            </md-input-container>
          </div>
          <md-button class="md-raised md-primary" ng-click="generateflsSimpleQueryReport()">Generate report</md-button>
        </fieldset>
      </div>
    </md-content>
    <div layout="column" layout-align="center" ng-if="report.status.loading">
      <div>
        <md-progress-circular md-mode="indeterminate"></md-progress-circular>
      </div>
      <div>Loading...</div>
    </div>
    <div ng-if="report.status.loaded">
      <div ng-if="report.status.isInError">
        <b>{{ report.status.message }}</b>
        <br/>
        <b>HTTP Status:</b>
        {{ report.status.response.status }}
        <br/>
        <b>Error:</b>
        {{ report.status.response.error }}
        <br/>
        <b>Server Response:</b>
        {{ report.status.response.message }}
        <br/>
      </div>
      <div ng-if="!report.status.isInError">
        <md-table-container>
          <table md-table="">
            <thead md-head="" md-on-reorder="getDesserts" md-order="query.order">
            <tr md-row="">
              <th md-column="">Node Name</th>
              <th md-column="">Node Type</th>
              <th md-column="">Data Type</th>
              <th md-column="">ROP Start Time</th>
              <th md-column="">ROP End Time</th>
              <th md-column="">Record Details</th>
            </tr>
            </thead>
            <tbody md-body="">
            <tr md-row=""
                ng-repeat="flsRecord in report.output.data | limitTo: report.output.pageLimit: (report.output.currentPage - 1) * report.output.pageLimit">
              <td md-cell="">{{ flsRecord.nodeName }}</td>
              <td md-cell="">{{ flsRecord.nodeType }}</td>
              <td md-cell="">{{ flsRecord.dataType }}</td>
              <td md-cell="">{{ flsRecord.ropStartTimeFormatted }}</td>
              <td md-cell="">{{ flsRecord.ropEndTimeFormatted }}</td>
              <td md-cell="">
                <md-button aria-label="View record details" class="md-icon-button launch"
                           ng-click="viewFlsRecordDetails(flsRecord)" title="View record details">
                  <md-icon
                    md-svg-icon="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRoLTI0eiIgZmlsbD0ibm9uZSIvPgogICAgPHBhdGggZD0iTTE5IDE5aC0xNHYtMTRoN3YtMmgtN2MtMS4xMSAwLTIgLjktMiAydjE0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0ydi03aC0ydjd6bS01LTE2djJoMy41OWwtOS44MyA5LjgzIDEuNDEgMS40MSA5LjgzLTkuODN2My41OWgydi03aC03eiIvPgo8L3N2Zz4K"></md-icon>
                </md-button>
              </td>
            </tr>
            </tbody>
          </table>
        </md-table-container>
        <md-table-pagination md-label="" md-limit="report.output.pageLimit" md-page="report.output.currentPage"
                             md-page-select="" md-total="{{ report.output.data.length }}"></md-table-pagination>
      </div>
    </div>
    <md-dialog-actions>
      <md-button class="md-primary" ng-click="downloadAsCsv()">Download as CSV</md-button>
      <md-button class="md-primary" ng-click="cancelOrClose()">Close</md-button>
    </md-dialog-actions>
  </md-dialog-content>
</md-dialog>
